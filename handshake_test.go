package grtmp

import (
	"bytes"
	"encoding/hex"
	"github.com/stretchr/testify/assert"
	"testing"
)

func TestHandshakeServer(t *testing.T) {
	type testCase struct {
		c0c1hex string
		c2hex   string
	}

	cases := []testCase{
		// obs
		{
			c0c1hex: "03f8a2c43a00000000f7982a2ece97a06e1f8e4e7156cf545c7546f8432fced96055a16f7bc212c95da8aeee3b55b60c33a2a0960792ef0b32e9739d2d64dd243c15ef421824585e52bbcdec2f91c8b663bbda29751567d70e4f9bb05f9d90a4431c561269287ed332298eff5a6b54ce3f875d08039f4b341a29c1505fa29bb92ea5c0981bca9e8f49800502740052b730fc9668532ba5907760e74b39036d432695f3a914ccc5b6215ee57366deb2d7421a2f205fc084f439f9763764d50864752814807aec8cab6eb712b1408fcd4329737c6c22ad735e000b63fc386784ca41efa7ba5664686778fdbaf64c845f6e5a7e01410460f9c84771326c5b9bc7631cac9fc55ac203766414e9f07fab615621a632262ef547c74db74d4556a055f15f95ac2c5dfd99f61f6fc1f7766e9bbc03ac5480530813370e8279c2418867b746fd35ee322a8f1a35a229ad624a7d8856a8b1d91a5d9a1e4aaf75281f2444461972a423548563017035ea2c6b8b74c4519d7bbf38869d4c2384daf97a2f4f7929eeab3d5b0ec5e22dab31f70212d3dd32d55c4c019da4623c635e25701aef57251da712309379991883aefc03801c25426d397212912c180941e81512ad0c435c2d61f53508edbe0099a8bb76b5113a1a868f605ac4d46e7924ce525b53cc5b19266ac359d4126e2c1533966e6be0f34631b512352fbf355f7ed79a41d8b2b91ca3918c636497ad218237ae0bcb3dbe5af708cb7facd1b96af1a9744df1344126d6cdfa02219edf1fe09806125ea31e6f50a977444ee60c0c1011e42255431c2b8f97884c8a54961b2c3e882a84d0a9568fb6b826257ad9281628e25d81ecb52a0f1fba0dd3184d367ee0987fa4b1ba0d068de45b0bb4e679b37c3619b3d83448cef47e053303fa515033e87426058138c51e791e2427d321d5bdae2d6102312b6e44931e70a1715666ec1d3e663c8b1e345c2a476c7e0b2e11fc9874e4fbcc67f96aad42a2234a076b64691445b73f13e21c193c4158b714071e03114a66a86363b7d344e2e7ac27c7baab48178473024203e56d6b1a39560693f53e348f876c96d6ca37772ece65d8ba4c436cdd7e62f80ffb76ce9fd55cffbcee4cce30ba4d3f4cda7a1cfbc31160f49a5995f8214c3f25474a3271de041d8cd9275bd87d3be05c074381986218a8490a7192ee695a9de1ad60013cb7373a82c45e71de41370ee97245c0b9227b682bd124bacb7820fd30875a7960a16102dac429bacec43a7a33e04e0ab753617123163f12f07046df51a1203518063fe65f1f29210ad14ae622f061455c835c76e51e34b5c06a586cd89148acbf175ffae528105f88126dea4cb75bb0c51a5f97d6a856f37fa066285f30335955b72cfe5c44388e443510f2ce2719c57e8304d3b9f75439f7c85328eade2e2200df2c31cf816484cd4906559853573d2136310845c058bd3df4367a5f015d4a722305e85a245a9463cc080f8e9d228a8cd9153ac3997d4155e079e95cfd760602df735813fe351912a83be8453c17428e11769ccb927aa2ad753b2d85da2a55635d70159b24034f814158cd969034b1879c00c7759024926e24086b37d70fec59777ac4d3b03158021f508008d323df1dd373e1564e29f6e22956abb0f357a9d7d33ffbb8f36c9e9ef5740fd380291293a048fea717263b28165b3568ab0b8f754622dd10d03fe53d037567c1d4279f65e5002eaa725452dd02342b4d102899563a46d47a0b20bb04ad51e1ba113682250446b79d3a3a3e77485ecdb78c67d7287747e85f1a60a2a98e63befd222b12db4006f37dee0ba3e28e56ba67c13e8604810b50ff4f43b6ff0239f722e27391c165035518870d637b4e2027b18600b677d80a4a539b09332479342eab377d3b99c7516f1a1d070f71b207bb931c542105272004cac161bffeb57906ec671bf88bb8438469ed08b05daa1a7ddbec2682ff3d0808b4511ec5880206984061108ec3d7604dd167757252de7248f5f661377c611c6f0d22445b15a0177b15da0edb45b80fed34f20a38b97023b51d903da6758e406606ce48e137064ecbbc3e7a20f2dc2ce2299c5d71e481372fd3bc30a8cbcc3cc7a14e2900255f690b5976653715d03c12ed20015239ac182543e752a85ce94c0a41c26c4e2f3c45",
			c2hex:   "9fa274a00000000072616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b65",
		},
		// ffmpeg
		{
			c0c1hex: "030000000009007c02f778551eceab8e1e362f07c5868a70b266d40220e5086118a22e3697d5fc2b6329c22ee7c7c9b0b5b345dfa8398fea3bc879208a1068425aa1174cb57258cfebe24da42ec4ff9da19c7b406f18c95bfdd04ee48b6f833214a47b8bf68eb05254e25ae9a9a8b496c5496f6e9cd7c68cb6bcc84169e67f3e372ffe186da8513862c5afdeb5a1218a860baccdd869b253dbab8a0efb59a48c442099875e55b74fd07a1b69af303e099873cb77e2d9e2c4741eb1f506a7f0b2962af91f5051c890a320994f4c8b36a01fa9c0f15f4b7cf7b6c3817da60918611d3b02ff7cc94038937537d3382e416bd57577834df9caf748352150ce92d0dbb40e871fc364e18b7e3569e39876c1ae0cb79ff6d7ab32f9f011869c8da4191ef46d3c1bc6b72d83812f2243d1752a412632d66a2075f5d302f45cdf2b98b802b79805dc4837d84eded1cc42cba7eec3137bf86dd0b2d7f624d521a3ff655bcf0df4101341d230e94651628e45a7abf8183101ce981e5e86a6faec5c79aa7ec7181ea459ed966e0c932a6f9e4bf554ab7b1c905cde054ed40d2fb89bbfc65752e58cfde4f2a04dc3ad1e5ef4fc64d57b071c14146a451f6a043156d2880f5957d78dfd3ff2b880f624ac70f27094f37734eaf1924f66ac3d648ae232930544a4420b65eed4696f7f50fe05fc948516650bfb9b65f953d848e3456965d0d76b627a84e35e9ddabd8b43f0fadaee458cdf59ebd773922e0ae507d5e64092e90ec67ed8439e8f221c753a9f9216f1cb85b5107bc7cc7c4fb2c3eed1afc709b192f50de69c1ffca5650efb523b5fab5997cac4b7ef5af2bf5973e6293bae1fc1da499be5515077de4ddb3f7fbcd741711c62b7d803b8d054cf578182714d1c445bd692ba1b839a09e7266fc85daa8fad433dabbd206cde1ea571770c6bfa7956c266ee8435eb01caa6f583c0d83c33eefcf3f97db917bdb299f8a89fb8860ab1cd644c1e82cce1323a9eb79d25f5dc570b70b40bb20061743353d0536ecdabd82f2277756228cb54fe6932c4c9bd130d2bfc700bf5d85da6946e96f82e0afd8e9c20cfeabf9a6a189bb17bbef539d1d9e73ee966fcb5d6bdbf98444de865be1605e34087b34cdf04e3aff55bd4137c522d2e3c7bf2634db326b22a474db7f8a0952ab3510de555396c18a378a8390b73bff7772fb2760fa5786a3b0459c45a1d1b0dff4cbbb65da0ed34f32116c3c2cc2b95825111bcfbb246c1505aa00c970d06d76cc950ce368b220db20487cba02bb1fc54b36567b42913d6b885062cd7795601d31a4a8e6d56467fa5c52162676fd526122513c3e47f2e6d9d6a19c4f8795431a94ced039221d27ac68a7a770e9305252271459b71d05505c4977b70e96851208bacdcdf7e682b3848840880f1fec2a32fb1406862bc83cad89adf729f3ba6ffd3fe808e8403e7c6a0f6dcda3211898f6f16505b078cc78b80db600ded2f200f25ff5dcb31d32cbe2056b8bdc31091631abbd2ac28d61fe32480ec5035bbf35f173393f0d59a21d2300b2db4b59eaa63ffe0f93d65dc028516905f22a9c7dff387c4eb78c6300e7ebbb2a6663cfbe5a9977caf5764ba3f0aba57db4e6051e0aec6e05b1bdaa649a97875edbc40bcc4214bb7fef72730d4368acbd3e10ab4c7642a1c53f93ca26db9c766555be26fdff0e2a721425b95762b0b776fd3e3eb17313d53129c9f34003c99a5196a8c6aacb6d64b51dd98b27c5b59a70bd941a1ba0300fb744cfc499d997e6d93392d28a767d116dfbc2cb9eb40540d11eb304ad9322386fdc597d55d3d1c67bc54df35479afb19ea2cd204dd331efb49c1e172f6bb89fbf58207dcae6c12f8a7598bef1e872c0c35f22b4c29df10f9bb1add3aeb887ab5fb38c036b88346f761c42f295dfe0b437dfb4f30a71276ab7d409ce424963f9ebb4f1f47e52b18786f279b5a87226f66981dd6d0ad11f49af31055ff69710fda3457c4b7852db2e3936d0778bf879f1734ad3a24ffb1ae9584760b9cb0452a53ba0962ffe2f605af52830bd211a5488894cc0b052255048711cd198510a9e943bf8b839198455fbd41073005d303990b88d9b63656d43cfec8ed83748f4b0f0fc5120216794b22a054e5bc58abd8c41096070884393453ce509694afbeabe0",
			c2hex:   "be0c5bc80d0e0a0d72616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e30202867159f078a4353eb4680afeba40df616cc82b44ccd468e28bbeeed690f66f32473627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b652067656e206279206c616c2076302e32312e3020286769746875622e636f6d2f713139313230313737312f6c616c2972616e646f6d20627566206f662072746d702068616e647368616b65",
		},
		// vlc
		{
			c0c1hex: "030000000009007c02f778551eceab8e1e362f07c5868a70b266d40220e5086118a22e3697d5fc2b6329c22ee7c7c9b0b5b345dfa8398fea3bc879208a1068425aa1174cb57258cfebe24da42ec4ff9da19c7b406f18c95bfdd04ee48b6f833214a47b8bf68eb05254e25ae9a9a8b496c5496f6e9cd7c68cb6bcc84169e67f3e372ffe186da8513862c5afdeb5a1218a860baccdd869b253dbab8a0efb59a48c442099875e55b74fd07a1b69af303e099873cb77e2d9e2c4741eb1f506a7f0b2962af91f5051c890a320994f4c8b36a01fa9c0f15f4b7cf7b6c3817da60918611d3b02ff7cc94038937537d3382e416bd57577834df9caf748352150ce92d0dbb40e871fc364e18b7e3569e39876c1ae0cb79ff6d7ab32f9f011869c8da4191ef46d3c1bc6b72d83812f2243d1752a412632d66a2075f5d302f45cdf2b98b802b79805dc4837d84eded1cc42cba7eec3137bf86dd0b2d7f624d521a3ff655bcf0df4101341d230e94651628e45a7abf8183101ce981e5e86a6faec5c79aa7ec7181ea459ed966e0c932a6f9e4bf554ab7b1c905cde054ed40d2fb89bbfc65752e58cfde4f2a04dc3ad1e5ef4fc64d57b071c14146a451f6a043156d2880f5957d78dfd3ff2b880f624ac70f27094f37734eaf1924f66ac3d648ae232930544a4420b65eed4696f7f50fe05fc948516650bfb9b65f953d848e3456965d0d76b627a84e35e9ddabd8b43f0fadaee458cdf59ebd773922e0ae507d5e64092e90ec67ed8439e8f221c753a9f9216f1cb85b5107bc7cc7c4fb2c3eed1afc709b192f50de69c1ffca5650efb523b5fab5997cac4b7ef5af2bf5973e6293bae1fc1da499be5515077de4ddb3f7fbcd741711c62b7d803b8d054cf578182714d1c445bd692ba1b839a09e7266fc85daa8fad433dabbd206cde1ea571770c6bfa7956c266ee8435eb01caa6f583c0d83c33eefcf3f97db917bdb299f8a89fb8860ab1cd644c1e82cce1323a9eb79d25f5dc570b70b40bb20061743353d0536ecdabd82f2277756228cb54fe6932c4c9bd130d2bfc700bf5d85da6946e96f82e0afd8e9c20cfeabf9a6a189bb17bbef539d1d9e73ee966fcb5d6bdbf98444de865be1605e34087b34cdf04e3aff55bd4137c522d2e3c7bf2634db326b22a474db7f8a0952ab3510de555396c18a378a8390b73bff7772fb2760fa5786a3b0459c45a1d1b0dff4cbbb65da0ed34f32116c3c2cc2b95825111bcfbb246c1505aa00c970d06d76cc950ce368b220db20487cba02bb1fc54b36567b42913d6b885062cd7795601d31a4a8e6d56467fa5c52162676fd526122513c3e47f2e6d9d6a19c4f8795431a94ced039221d27ac68a7a770e9305252271459b71d05505c4977b70e96851208bacdcdf7e682b3848840880f1fec2a32fb1406862bc83cad89adf729f3ba6ffd3fe808e8403e7c6a0f6dcda3211898f6f16505b078cc78b80db600ded2f200f25ff5dcb31d32cbe2056b8bdc31091631abbd2ac28d61fe32480ec5035bbf35f173393f0d59a21d2300b2db4b59eaa63ffe0f93d65dc028516905f22a9c7dff387c4eb78c6300e7ebbb2a6663cfbe5a9977caf5764ba3f0aba57db4e6051e0aec6e05b1bdaa649a97875edbc40bcc4214bb7fef72730d4368acbd3e10ab4c7642a1c53f93ca26db9c766555be26fdff0e2a721425b95762b0b776fd3e3eb17313d53129c9f34003c99a5196a8c6aacb6d64b51dd98b27c5b59a70bd941a1ba0300fb744cfc499d997e6d93392d28a767d116dfbc2cb9eb40540d11eb304ad9322386fdc597d55d3d1c67bc54df35479afb19ea2cd204dd331efb49c1e172f6bb89fbf58207dcae6c12f8a7598bef1e872c0c35f22b4c29df10f9bb1add3aeb887ab5fb38c036b88346f761c42f295dfe0b437dfb4f30a71276ab7d409ce424963f9ebb4f1f47e52b18786f279b5a87226f66981dd6d0ad11f49af31055ff69710fda3457c4b7852db2e3936d0778bf879f1734ad3a24ffb1ae9584760b9cb0452a53ba0962ffe2f605af52830bd211a5488894cc0b052255048711cd198510a9e943bf8b839198455fbd41073005d303990b88d9b63656d43cfec8ed83748f4b0f0fc5120216794b22a054e5bc58abd8c41096070884393453ce509694afbeabe0",
			c2hex:   "e25c15c22caf72d0986fbd3eda0d7151973e19083e0abbefa76e17d8a5fa9570ed547a9786e535612d45228c773e0ebef805ac8764a67552496a3cc3355805f99d03606784b05f55361fb4c66e6164f9b882156930ed76e7f27df8ed6ae6c0837b41413ead7023f2bd2e9dced663c8305cbabc22c3ebba207ea2a8c35ecf7828dce2633d38c8c2e9decf2553b161a212fc9a962e4490fba31d24a2eba8ebb4a60d6cf429142ad26fb656b9f12f4b1c22c0cd65497864dd83f0d03162ddedbc4e857c0ca391ed2f1e5a64948d096081a114721c0bc8a1635bf27036b8bcc09ed5b11d85bd547ca361e2d865842d7fe64bc3a29895a97cec5b2d29294f41abc2bc466cf38d8d00886036bfa45e4bdf484e9e5fe10b024a986e63f2b0e109a3ea420e25288bcac6931141f876b57e37f39c8c1bff23b566a7887b18b618ca4ef347009dd5005e7f413becfd0b26fffe15ec6ec998226e39365626c560cb2413527ce574c0a436f1b1788ac8bcd8d4e0bed13e7c799673069a7d8249c003b633ec6587d3e2d7d3f5aa4007149c04ac3df0a348aa8b27c986684afb93870ec5a623cad0d074d98cfbc2e1c424229bd020e5cc45548ac4f8938952a4b24cac82a602e9d8c026480d108915efe0b28d7efcd34e38395b7128cacdbaa83500d408d26ad913024d5d9ee2a0938dc31f6abc531f5f5b82ac56afd454b1d429956aae6bb5836d76ade8b8276e9795dd1e7f79a20f5a09296a7381d58f9670c30b869ac8022459fc883ccdc16eb68cd6c123562a416b99597635057d8592cfaa71f4f430054b69f5419cf8399c75c3c3e9b6db0d1c0292b5f88ebd322aa4667e7d6abaa752019a850c0d054e879cec2b2d943ab7bc7410ef715feaad9e6a8fc6a9053feafc60af15e46f47d3bf06c6e7001c1cd743d00d4313bfe73cfdfa3422f175965a5cf2f2159457d394b7e1fcb573a994db6789fbccf7b48056bca207f9039fa753bea7e4b58fc66b1e38963fe0b69cbd54b6d72aeb793502afb19af949e69a00d61a93f453603098bc40d3f6e22db5586c54a2f34d85415394c277aae2269cb7f4d612d699ca72ad222bccdec6ba4303455c70f4c9c19c8d0e6a0729fafa0b6962fec2c1f4709c7099fe64424e03f021d0e2b20c2196c25d3911995bbee34993c5cb42090946f4672d53a6d5e2334f6ca419c255b9eeb3f5c48d04fd79e364002bb7e923e523713d86cbce7750b1112fd52660bc5d2df7c6f6faf22d2c17d86bda72a45a83017dd4eee9b6754ce0ed8a84feefa7107cd996915bc73fa772bb5bbab82dc6fdf11d60ab5fac043d739f8d8b4df56cbf4a26352c5c874aff6ff14f951522501d602a128a3d9c7c3b23bdc78724c7f1712a4c094d42e84e0f7d8abee9e9a1b9aec34b52d41933b1bc518235a9ca324d7e6fd953ff0bf2d70fed5ddd11b6b0ece00f49bccd9124bfa9bbe3a042f440e68d781cc7fb576a9ba35a9b91e7c5d57bfa3d19490c268e65fc526fc6064941ab91b879a39d76c25b0a86d6179e4b4d0eb8350f08fb8a283809d4419ef5e05eff642267fe6420c809f54e591522198d345b4308a43f2209901d9c0a9cdae324137c2471b36d669cec915310a0c94a4199f2dda891ba4123789f8c70178e2fa6e2dfad26c2e3d875f536e54dd1dc4ab3953c960cf27154b95f041ed92f4a75618689f6ed9b278b4d871a3f9eacb37732ff918ef1be7a1b4466361caf7e000142bd008d6f89fd2ac83b289be32fced5a36b55f6dfc87563c847f67a0bb089784f56673a90e34508a3fce3e89d4291a72f7e132a89b18aba0d56f4a919e070d0de247ecccd11674b9ad30a095227ed83554c6fb5ca6ae820348cb95cb0566fee97b7f3a795b894b2d360993e7bf4a32e8a80637691c73fccbb36bf74a620df4da66ba390a2e12683d7ef1840fbaf5f0147ef1c25fc8fcde45e5e4a255b76d956388956bbf0528e8cc85292b6c4cf9aa0941ebecc7b5627fda32ce75ed2791164b86ad3b2742f9ce7833ae3c90a240b5b01760db94853689c41c08fa2c6bd29b0d5cd9a8dd9bfacf01f35d9349f7a663f6ea8ed7540ce8d683fa14c01095c94735a19a23fc386c241e5b5a6bd93362aaa00eb6ee637cad57344788addf645f571c7fb90ecde7a5460e383b9502a0c4e2838",
		},
	}

	ast := assert.New(t)

	for _, c := range cases {
		c0c1, _ := hex.DecodeString(c.c0c1hex)
		c2, _ := hex.DecodeString(c.c2hex)
		c0c1Buf := bytes.NewBuffer(c0c1)
		c2Buf := bytes.NewBuffer(c2)
		clientBuf := &bytes.Buffer{}

		hs := &HandshakeServer{}

		var err error
		err = hs.ReadC0C1(c0c1Buf)
		ast.Equal(nil, err)
		err = hs.WriteS0S1S2(clientBuf)
		ast.Equal(nil, err)
		err = hs.ReadC2(c2Buf)
		ast.Equal(nil, err)
	}
}
